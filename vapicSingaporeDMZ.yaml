---
    - name: Deploy vAPIC using ansible
      hosts: localhost
      become: no
      gather_facts: no
      vars:
        vcenter_server: "192.168.20.4"
        vcenter_user: "Administrator@dmz.cisco.demo"
        vcenter_password: "C1scoUC$"
        datacenter_name: "SGP"
        cluster_name: "HX-2"
        datastore_name: "Day2Ops2"
        vapic01: "vapic01-ansible"
        vapic02: "vapic02-ansible"
        vapic03: "vapic03-ansible"

      tasks:
      - name: Deploy vAPIC 01
        vmware_deploy_ovf:
          hostname: '{{ vcenter_server }}'
          username: '{{ vcenter_user }}'
          password: '{{ vcenter_password }}'
          validate_certs: no
          name: '{{ vapic01 }}'
          datacenter: '{{ datacenter_name }}'
          cluster: '{{ cluster_name }}'
          datastore: '{{ datastore_name }}'
          disk_provisioning: thin
          networks:
           "OOB Network": "common|default|vmConsole"
           "Infra Network": "vapic"
          ova: "/home/huyen/vapic/aci-apic-dk9.6.0.1.142.ova"
          allow_duplicates: no
          wait_for_ip_address: true
          
          inject_ovf_env: true
          properties:
            com.cisco.vapic.adminpassword: "C1sc0123!"
            com.cisco.vapic.oobip: "192.168.20.208/24"
            com.cisco.vapic.oobgw: "192.168.20.1"

      - name: Deploy vAPIC 02
        vmware_deploy_ovf:
          hostname: '{{ vcenter_server }}'
          username: '{{ vcenter_user }}'
          password: '{{ vcenter_password }}'
          validate_certs: no
          name: '{{ vapic02 }}'
          datacenter: '{{ datacenter_name }}'
          cluster: '{{ cluster_name }}'
          datastore: '{{ datastore_name }}'
          disk_provisioning: thin
          networks:
           "OOB Network": "common|default|vmConsole"
           "Infra Network": "vapic"
          ova: "/home/huyen/vapic/aci-apic-dk9.6.0.1.142.ova"
          allow_duplicates: no
          wait_for_ip_address: false
          
          inject_ovf_env: true
          properties:
            com.cisco.vapic.adminpassword: "C1sc0123!"
            com.cisco.vapic.oobip: "192.168.20.209/24"
            com.cisco.vapic.oobgw: "192.168.20.1"

      - name: Deploy vAPIC 03
        vmware_deploy_ovf:
          hostname: '{{ vcenter_server }}'
          username: '{{ vcenter_user }}'
          password: '{{ vcenter_password }}'
          validate_certs: no
          name: '{{ vapic03 }}'
          datacenter: '{{ datacenter_name }}'
          cluster: '{{ cluster_name }}'
          datastore: '{{ datastore_name }}'
          disk_provisioning: thin
          networks:
           "OOB Network": "common|default|vmConsole"
           "Infra Network": "vapic"
          ova: "/home/huyen/vapic/aci-apic-dk9.6.0.1.142.ova"
          allow_duplicates: no
          wait_for_ip_address: false
          inject_ovf_env: true
          properties:
            com.cisco.vapic.adminpassword: "C1sc0123!"
            com.cisco.vapic.oobip: "192.168.20.210/24"
            com.cisco.vapic.oobgw: "192.168.20.1"